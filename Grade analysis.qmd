---
title: "Grade analysis"
format: html
---

```{r}
# | message: false
here::i_am("r-101-grade-analysis.Rproj")
library(here)
library(vroom)
library(dplyr)
library(tidyr)
library(ggplot2)
```



## Question 1
```{r}
grade <- vroom(here("grades.csv"))
```

## Question 2
```{r}
exam <-
  grade |>
  summarise(min(Exam, na.rm = TRUE),
            max(Exam, na.rm = TRUE),
            median(Exam, na.rm = TRUE),
            mean(Exam, na.rm = TRUE))
  
knitr::kable(exam)
```

## Question 3
```{r}
na_exam <- 
  grade |>
  filter(is.na(Exam)) |> nrow()
```


We observe that `r na_exam` students did not take the exam.


## Question 4
```{r}
grade |>
  ggplot(aes(x=Exam)) + geom_bar() +
  labs(title = "Distribution of grades at the exam")
```

## Question 5
```{r}
students_by_group <- 
  grade |>
  reframe(.by=Group, Id) |>
  group_by(Group)|>
  summarise(Count = n())

knitr::kable(students_by_group)
```

## Question 6
```{r}
students_by_group |>
ggplot(aes(x = Group, y = Count)) +
  geom_bar(stat = "identity") +
  labs(title = "Number of students in each group")
```

## Question 7
```{r}
grade |>
  ggplot(aes(x=Exam)) + 
  geom_histogram(na.rm = TRUE) + 
  facet_wrap(~Group) +
  labs(title = "Distribution of grades at the exam by groups")
```

## Question 8
```{r}
na_exam_by_groups <- 
  grade |>
  reframe(.by=Group, Id, Exam) |>
  group_by(Group) |>
  summarise(na_exam = sum(is.na(Exam)))
```

## Question 9
```{r}
na_exam_by_groups |>
  ggplot(aes(x=Group, y=na_exam)) + geom_col() +
  labs(title = "Distribution of missed exam by groups" , y = "Number of missed exam")
```

## Question 10
```{r}
grade_long_form <-
  grade |>
  pivot_longer(cols = -c(Id, Group))
```


## Question 11
```{r}
missed_grades_in_grade_long_form <-
  grade_long_form |>
  group_by(Id) |>
  summarise(missed_exam = sum(is.na(value)))
```

## Question 12
```{r}
missed_grades_in_grade_long_form |>
  ggplot(aes(x=missed_exam)) + geom_bar() +
  labs(title = "Distribution of missed exam per student")
```

## Question 13
```{r}
grade_long_form_by_group <-
  grade_long_form |>
  filter(.by = Id) |>
  count(is.na(value))

  
```

## Question 14
```{r}

```

